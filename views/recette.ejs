<% include header %>
<link rel="stylesheet" type="text/css" href="/stylesheets/recette.css">

<% for (recette of recettes) { %>

    <!--
<% for (ingredient of ingredients) { %>
    <p><%= ingredient.id_recette %></p>
    <p><%= ingredient.id_ingredient %></p>
    <p><%= ingredient.nom %></p>
    <p><%= ingredient.quantite %></p>
    <p><%= ingredient.type %></p>
<% } %>

<% for (typeRecette of typeRecette) { %>
    <p><%= typeRecette.nom %></p>
<% } %>

-->

    <div class="container-fluid p-0">

        <div class="recette-content text-center mx-auto mt-3">
            <h2 class="grd-titre"><%= recette.nom %></h2>
            <h3 class="ss-titre"><%= recette.categorie %> - <%= recette.sousCategorie %></h3>
            <div class=" note"> Note /5</div>
            <div class="text-secondary allergenes">
                <%= recette.description %>
            </div>
            <div>
                <p></p>
            </div>


            <!--<img src="/images/img_course.jpg" class="mx-auto d-block" alt="img cereales">-->
            <% var bool = true %>

            <div id="recette-img-carousel" class="carousel slide mx-auto" data-ride="carousel">
                <div class="carousel-inner">
                    <div class="carousel-item active">
                        <% for (image of image) { %>
                            <% if(bool){ %>
                                <img src="/images/recette/<%= recette.id %>/<%= image.chemin %>"
                                     class="d-block mx-auto w-100 p-0 img-carou" alt="...">
                    </div>
                    <% bool = false;}else{ %>
                        <div class="carousel-item">
                            <img src="/images/recette/<%= recette.id %>/<%= image.chemin %>"
                                 class="d-block mx-auto w-100 p-0 img-carou" alt="...">
                        </div>
                    <% } %>
                    <% } %>
                </div>
                <a class="carousel-control-prev " href="#recette-img-carousel" role="button" data-slide="prev">
                    <div class="arrow-container mx-auto">
                        <span class="carousel-control-prev-icon carousel-button mt-1 mr-1" aria-hidden="true"></span>
                        <span class="sr-only">Previous</span>
                    </div>

                </a>
                <a class="carousel-control-next" href="#recette-img-carousel" role="button" data-slide="next">
                    <div class="arrow-container mx-auto">
                        <span class="carousel-control-next-icon carousel-button mt-1 ml-1" aria-hidden="true"></span>
                        <span class="sr-only">Next</span>
                    </div>
                </a>
            </div>


            <section class="reseau mx-auto text-center"> Réseau social</section>


            <div class="container conditions text-center guide-container shadow-lg p-1 p-lg-3 mb-5 bg-white rounded">
                <% if (login != undefined){ %>
                    <% if (estFav){ %>
                        <form action="/recette/<%= idRecette%>" method="post" >
                            <input type="hidden" name="favAction" value="remove" >
                            <button type="submit" class="btn btn-outline-danger">Supprimer des Favoris</button>
                        </form>
                    <% }else{ %>
                        <form action="/recette/<%= idRecette%>" method="post" >
                            <input type="hidden" name="favAction" value="add" >
                            <button type="submit"  class="btn btn-outline-success favoris-btn">Ajouter aux Favoris <span class="favoris-star">★</span></button>
                        </form>
                    <% } %>
                <% } %>
                <div class="h4 text-center mt-4 titre-guide"> Guide de préparation</div>
                <div class="row font-weight-bold guide-conditions">
                    <div class="col">Temps total</div>
                    <div class="col">Difficulté</div>
                    <div class="col">Coût</div>
                </div>
                <div class="row guide-rep">
                    <div class="col"><%= recette.tempsPreparation + recette.tempsCuisson %> minutes</div>
                    <div class="col"><%= recette.difficulte %></div>
                    <div class="col">moyen</div>
                </div>

                <div class="container mt-5">
                    <div class="row text-center">

                        <div class="col-5 ingredient">
                            <h5>Ingrédient</h5>
                            <div class="container mt-3 p-0">
                                <div class="row">
                                    <div class="col">
                                        <p class="mb-0 mt-2">Nombre d'adultes</p>
                                        <div class="input-group mb-3">
                                            <button class="btn btn-outline-secondary btn-remove" type="button">-
                                            </button>
                                            <input type="type" id="adult-quantity"
                                                   class="form-control text-center input-quantity"
                                                   onkeypress='return event.charCode >= 48 && event.charCode <= 57'/>
                                            <button class="btn btn-outline-secondary btn-add" type="button">+</button>
                                        </div>
                                    </div>
                                    <div class="col">
                                        <p class="mb-0 mt-2">Nombre d'enfants</p>
                                        <div class="input-group mb-3">
                                            <button class="btn btn-outline-secondary btn-remove" type="button">-
                                            </button>
                                            <input type="type" id="child-quantity"
                                                   class="form-control text-center input-quantity"
                                                   onkeypress='return event.charCode >= 48 && event.charCode <= 57'/>
                                            <button class="btn btn-outline-secondary btn-add" type="button">+</button>
                                        </div>
                                    </div>
                                </div>


                            </div>

                            <% for (ingredient of ingredients) { %>
                                <div class="card mb-3 p-1" style="max-width: 540px;">
                                    <div class="row no-gutters">
                                        <div class="col-md-4">
                                            <img src="/images/ingrédients/<%= ingredient.photo %>" class="card-img"
                                                 alt="ingredient">
                                        </div>
                                        <div class="col-md-8">
                                            <div class="card-body ">
                                                <p class="card-text mb-0 font-weight-bold"><%= ingredient.nom %></p>
                                                <p class="card-text mb-0 font-weight-lighter font-italic">
                                                    <span class="quantity"><%= ingredient.quantite %></span>
                                                    <% if(ingredient.type == 0){ %>g
                                                    <% } %>
                                                    <% if(ingredient.type == 1){ %>cl
                                                    <% } %>
                                                    <% if(ingredient.type == 2){ %>
                                                    <% } %>
                                                    <% if(ingredient.type == 3){ %>
                                                    <% } %>
                                                    <% if(ingredient.type == 4){ %>cueillères à soupe
                                                    <% } %>
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            <% } %>
                        </div>


                        <div class="col-7">
                            <h5>Préparation</h5>
                            <div>
                                <p class="mb-0">Préparation : <span
                                            class="font-weight-bold"><%= recette.tempsPreparation %></span> minutes</p>
                                <p>Cuisson : <span class="font-weight-bold"><%= recette.tempsCuisson %> </span> minutes
                                </p>
                                <video id=recette-video" class="col-12 col-sm-12 col-md-10 col-lg-10 col-xl-10 p-0"
                                       preload="auto" controls>
                                    <source src="/video/<%= recette.video %>" type="video/mp4">
                                </video>
                            </div>
                            <div>
                                <input type="checkbox" id="thermomix" name="Thermomix">
                                <label for="Thermomix">Thermomix</label>
                            </div>
                            <ol class="liste-preparation mt-3 ml-3">
                                <% for (preparation of preparation) { %>
                                    <li class="text-left mb-3 numero-preparation"><%= preparation.description %></li>
                                <% } %>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>


<% } %>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="/javascripts/recette.js"></script>
<% include footer %>
